# Development Dockerfile with all tools
FROM golang:1.25-alpine

# Install development dependencies
RUN apk add --no-cache \
    git \
    make \
    bash \
    curl \
    ca-certificates \
    gcc \
    musl-dev \
    && rm -rf /var/cache/apk/*

# Set shell to use pipefail (Alpine uses ash)
SHELL ["/bin/ash", "-o", "pipefail", "-c"]

# Install mise for tool management
RUN curl https://mise.run | sh
ENV PATH="/root/.local/bin:${PATH}"

WORKDIR /workspace

# Install air for live reload (pinned version)
RUN go install github.com/cosmtrek/air@v1.63.1

# Install development tools via mise
COPY mise.toml .
RUN mise install

# Set up environment
ENV CGO_ENABLED=0
ENV GOOS=linux
ENV GOARCH=amd64

# Default command
CMD ["bash"]
