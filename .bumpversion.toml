# bump-my-version configuration
# https://github.com/callowayproject/bump-my-version

[tool.bumpversion]
current_version = "0.1.0"
# Version format: 1.13.0, 1.13.0-rc1, 1.13.0-beta3, 1.13.0-alpha20250708
# Note: Alpha versions with dates are handled in pre-release workflow
parse = "(?P<major>\\d+)\\.(?P<minor>\\d+)\\.(?P<patch>\\d+)(\\-(?P<pre_label>rc|beta|alpha)(?P<pre_num>\\d+))?"
serialize = [
    "{major}.{minor}.{patch}-{pre_label}{pre_num}",
    "{major}.{minor}.{patch}",
]
search = "{current_version}"
replace = "{new_version}"
regex = false
ignore_missing_version = false
ignore_missing_files = false
tag = false  # We handle tagging in GitHub Actions
commit = false  # We handle commits in GitHub Actions
message = "chore(release): bump version to {new_version}"

# Source of truth
[[tool.bumpversion.files]]
filename = "internal/version/VERSION"
search = "{current_version}"
replace = "{new_version}"

# README.md - GitHub Action version references
[[tool.bumpversion.files]]
filename = "README.md"
search = "@v{current_version}"
replace = "@v{new_version}"

# README.md - Also search for major.minor version references (e.g., @v0.1)
[[tool.bumpversion.files]]
filename = "README.md"
search = "@v{current_major}.{current_minor}"
replace = "@v{new_major}.{new_minor}"

# SECURITY.md - Supported version matrix
[[tool.bumpversion.files]]
filename = "SECURITY.md"
search = "{current_major}.{current_minor}.x"
replace = "{new_major}.{new_minor}.x"

# SECURITY.md - Version pinning examples
[[tool.bumpversion.files]]
filename = "SECURITY.md"
search = "@v{current_version}"
replace = "@v{new_version}"

# docs/action-usage.md - Action version examples
[[tool.bumpversion.files]]
filename = "docs/action-usage.md"
search = "@v{current_version}"
replace = "@v{new_version}"

# docs/action-usage.md - Also update major.minor references
[[tool.bumpversion.files]]
filename = "docs/action-usage.md"
search = "@v{current_major}.{current_minor}"
replace = "@v{new_major}.{new_minor}"

# docs/versioning.md - Version examples throughout
[[tool.bumpversion.files]]
filename = "docs/versioning.md"
search = "{current_version}"
replace = "{new_version}"

# docs/versioning.md - Major.minor version references
[[tool.bumpversion.files]]
filename = "docs/versioning.md"
search = "@v{current_major}.{current_minor}"
replace = "@v{new_major}.{new_minor}"

# docs/patch-release-workflow.md - Version examples
[[tool.bumpversion.files]]
filename = "docs/patch-release-workflow.md"
search = "{current_version}"
replace = "{new_version}"

# docs/patch-release-workflow.md - Major.minor version references
[[tool.bumpversion.files]]
filename = "docs/patch-release-workflow.md"
search = "@v{current_major}.{current_minor}"
replace = "@v{new_major}.{new_minor}"

# examples/plugins/README.md - Plugin compatibility version
[[tool.bumpversion.files]]
filename = "examples/plugins/README.md"
search = "RequiredUptoolVersion = \"{current_version}\""
replace = "RequiredUptoolVersion = \"{new_version}\""

# examples/plugins/python/go.mod - Plugin dependency version
[[tool.bumpversion.files]]
filename = "examples/plugins/python/go.mod"
search = "require github.com/santosr2/uptool v{current_version}"
replace = "require github.com/santosr2/uptool v{new_version}"

# mkdocs.yml - uptool_version variable for GitHub URLs
[[tool.bumpversion.files]]
filename = "mkdocs.yml"
search = "uptool_version: v{current_version}"
replace = "uptool_version: v{new_version}"

# .github/MARKETPLACE.md - GitHub Action version references
# [[tool.bumpversion.files]]
# filename = ".github/MARKETPLACE.md"
# search = "@v{current_major}"
# replace = "@v{new_major}"

# docs/quickstart.md - Action version references (major.minor)
[[tool.bumpversion.files]]
filename = "docs/quickstart.md"
search = "@v{current_major}.{current_minor}"
replace = "@v{new_major}.{new_minor}"

# docs/migration.md - Action version references (major only)
# [[tool.bumpversion.files]]
# filename = "docs/migration.md"
# search = "@v{current_major}"
# replace = "@v{new_major}"

# Pre-release configuration
[tool.bumpversion.parts.pre_label]
optional_value = "final"
values = ["alpha", "beta", "rc", "final"]

[tool.bumpversion.parts.pre_num]
first_value = 1
