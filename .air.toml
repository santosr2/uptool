#:schema https://json.schemastore.org/any.json

# Air configuration for live reload
# Config file for Air (https://github.com/air-verse/air) in TOML format
# See example: https://github.com/cosmtrek/air/blob/master/air_example.toml

# Working directory
# . or absolute path, please note that the directories following must be under root
root = "."
tmp_dir = "tmp"

[build]
  # Commands to run before each build (optional)
  # pre_cmd = ["go generate ./..."]

  # Main build command
  cmd = "go build -o ./tmp/main ./cmd/uptool"

  # Commands to run after ^C (optional)
  # post_cmd = ["echo 'Stopped'"]

  # Binary file yields from 'cmd' (DEPRECATED - use entrypoint instead)
  # bin = "./tmp/main"

  # Entrypoint binary relative to root (recommended over bin)
  # First item is the executable, additional items are default arguments
  entrypoint = ["./tmp/main"]

  # Customize binary with environment variables (optional)
  # full_bin = "UPTOOL_DEBUG=true ./tmp/main"

  # Add additional arguments when running binary
  # For development, you might want to add: ["--verbose"]
  args_bin = []

  # Watch these filename extensions
  include_ext = ["go", "tpl", "tmpl", "html"]

  # Ignore these directories
  exclude_dir = [
    "dist",
    "vendor",
    "testdata",
    "docs",
    ".git",
    ".github",
    "examples",
    "scripts",
    "tmp",
    ".mise",
    "coverage"
  ]

  # Watch these directories if specified (optional)
  include_dir = []

  # Watch specific files (optional)
  include_file = []

  # Exclude specific files (optional)
  exclude_file = []

  # Exclude files matching these regex patterns
  exclude_regex = ["_test\\.go"]

  # Exclude unchanged files (recommended: true)
  exclude_unchanged = true

  # Follow symlink for directories
  follow_symlink = true

  # Log file placed in tmp_dir
  log = "build-errors.log"

  # Poll files for changes instead of using fsnotify (useful in Docker on some systems)
  poll = false

  # Poll interval in milliseconds (default: 500)
  poll_interval = 500

  # Delay before triggering build after file change (ms)
  # Prevents excessive builds from rapid file changes
  delay = 1000

  # Stop running old binary when build errors occur
  stop_on_error = true

  # Send Interrupt signal before killing process (not supported on Windows)
  send_interrupt = false

  # Delay after sending Interrupt signal (nanoseconds)
  kill_delay = 500

  # Rerun binary after it exits
  rerun = false

  # Delay after each execution (ms)
  rerun_delay = 500

[log]
  # Show log time
  time = false

  # Only show main log (silences watcher, build, runner)
  main_only = false

  # Silence all logs produced by air
  silent = false

[color]
  # Customize each part's color
  # If no color found, use the raw app log
  main = "magenta"
  watcher = "cyan"
  build = "yellow"
  runner = "green"
  # app = ""  # Color for application output (empty = no coloring)

[misc]
  # Delete tmp directory on exit
  clean_on_exit = true

[screen]
  # Clear screen on rebuild
  clear_on_rebuild = true

  # Keep scroll position
  keep_scroll = true

# [proxy]
# Enable live-reloading on the browser (useful for web apps)
# Not needed for CLI tools like uptool
# enabled = false
# proxy_port = 8090
# app_port = 8080
